% wavelet homework function
% two channels analysis bank of filter bank
% Ran DUAN 16-01-2015
function [H_out, L_out] = analysis_bank_1d_basic(s,h)

% low pass filtering
%h=[0.02667005790099; 0.18817680007791;   0.52720118893175;   0.68845903945367;  0.28117234366087;  -0.24984642432688;  -0.19594627437691;   0.12736934033594;   0.09305736460396;  -0.07139414716597;  -0.02945753682199;   0.03321267405898;  0.00360655356700;  -0.01073317548299;   0.00139535174700;   0.00199240529500;  -0.00068585669500;  -0.00011646685500;   0.00009358867000;  -0.00001326420300]'
%h=h/sqrt(2);
% sp=filter(h,1,s);
sp = pconv(h,s);

% downsampling
L_out=sp(1:2:length(sp));


% create high pass filter
% g=h.*power(-1*ones(1,length(h)),(0:length(h)-1));
%g=[ 0.02667005790099  -0.18817680007791   0.52720118893175  -0.68845903945367   0.28117234366087   0.24984642432688  -0.19594627437691  -0.12736934033594   0.09305736460396   0.07139414716597  -0.02945753682199  -0.03321267405898   0.00360655356700   0.01073317548299   0.00139535174700  -0.00199240529500  -0.00068585669500   0.00011646685500   0.00009358867000   0.00001326420300]
%g=g/sqrt(2);
% sp=filter(g,1,s);
for n=1:length(h),
   g(n)=h(n)*(-1)^(n);
end;
g=g(length(g):-1:1);
sp = pconv(g,s);

% downsampling
H_out=sp(1:2:length(sp));

end